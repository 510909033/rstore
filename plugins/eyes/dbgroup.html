<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="description" content=""><meta name="author" content=""><title>Rstore Eyes Plugin | v1.0</title><link href="css/bootstrap.min.css" rel="stylesheet"><link href="css/bootstrap-table.min.css" rel="stylesheet"><script src="js/json_syntax_highlight.js"></script><script src="js/jquery-3.1.1.min.js"></script><script src="js/bootstrap.min.js"></script><script src="js/bootstrap-table.min.js"></script><script src="js/jsoneditor.min.js"></script><script src="js/common.js"></script><style>.breadcrumb{margin-top:50px}.string{color:green}.number{color:#ff8c00}.boolean{color:#00f}.null{color:#ff00ff}.key{color:red}</style></head><body><div id="common_confirm_model" class="modal"><div class="modal-dialog modal-sm"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">&times;</span></button><h5 class="modal-title"><i class="fa fa-exclamation-circle"></i> <span class="title"></span></h5></div><div class="modal-body small"><p><span class="message"></span></p></div><div class="modal-footer"><button type="button" class="btn btn-primary ok" data-dismiss="modal">OK</button> <button type="button" class="btn btn-default cancel" data-dismiss="modal">Cancel</button></div></div></div></div><div id="myModal" class="modal fade" role="dialog"><div class="modal-dialog" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title title"></h4></div><div class="modal-body"><pre class="message"></pre></div><div class="modal-footer"><button type="button" class="btn btn-default ok" data-dismiss="modal">OK</button></div></div></div></div><div id="editModal" class="modal fade" tabindex="-2" role="dialog"><div class="modal-dialog modal-lg"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="editModalTitle"></h4></div><div class="modal-body"><section class="section"><ul class="nav nav-tabs" id="tabScm"><li id="tabRedis"><a href="#">Redis</a></li><li id="tabPostgres"><a href="#">Postgres</a></li><li id="tabMysql"><a href="#">Mysql</a></li></ul><div class="row"><div class="col-md-6"><div class="card card-block sameheight-item"><div id="editor_holder"></div></div></div><div class="col-md-6"><div class="card card-block"><h3>Preview</h3><pre id="preview"></pre><button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button> <input id="save" class="btn btn-success" href="#" type="button" value="Save Or Update"></div></div></div></section></div><div class="modal-footer"></div></div></div></div><div class="navbar navbar-inverse navbar-fixed-top" role="navigation"><div class="container"><div class="navbar-left" style="padding-right:10px"><img src="logo.png" width="40px"></div><div class="navbar-header"><a class="navbar-brand" href="index.html">RstoreEyes</a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav"><li><a href="db.html">DBUnit</a></li><li><a href="dbgroup.html">DBGroup</a></li><li><a href="shard.html">Shard</a></li><li><a href="rule.html">Rule</a></li></ul><ul class="nav navbar-nav navbar-right"><li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-share-alt"></i> GitHub <b class="caret"></b></a><ul class="dropdown-menu"><li><a target="_blank" href="https://github.com/lycying/rstore">Source</a></li></ul></li><li><a href="../../debug/pprof/" target="_blank">Pprof</a></li></ul></div></div></div><div class="container"><ul class="breadcrumb"><li><a href="index.html">Home</a> <span class="divider">&gt;</span></li><li class="active">DB Group List</li></ul><div id="dbGroupToolbar"><button type="button" class="btn btn-primary btn-xs addNewBtn"><span class="glyphicon glyphicon-plus" aria-hidden="true"></span>add new db group</button></div><table id="dbGroupTable" data-striped="false" data-toggle="table" data-show-toggle="true" data-toolbar="#dbGroupToolbar" data-show-columns="true" data-search="true" data-side-pagination="client" data-pagination="true" data-show-refresh="true" data-cache="false" data-sort-name="Name" data-sort-order="asc" data-url="../../api/dbgroup/all"><thead><tr><th data-field="Type">Type</th><th data-field="Name" data-sortable="true">Name(Unique)</th><th data-field="State" data-formatter="state">E/S</th><th data-field="Items" data-formatter="items">Masters/Slaves</th><th data-field="ReplicateMode">ReplicateMode</th><th data-field="Mark">Mark</th><th data-field="Optr" data-formatter="optr" data-events="operateEvents">Operate</th></tr></thead></table><script>var scm={type:"object",title:"DB Group",properties:{Type:{type:"string",required:!0,enum:["redis","postgres","mysql"]},Name:{type:"string",title:"Supply a unique name",default:""},Enable:{type:"boolean",title:"If inused",format:"checkbox"},ReplicateMode:{type:"string",title:"ReplicateMode",required:!0,enum:["writeall","writeone","discard"]},Mark:{type:"string",title:"Mark",format:"textarea",default:""},Items:{type:"array",title:"DB Items",items:{type:"object",title:"DBGroup Item",properties:{Name:{type:"string",title:"DBRef",format:"select",required:!0,enum:["redis"]},IsMaster:{type:"boolean",title:"Master",format:"checkbox",default:!0},ReadWeight:{type:"integer",title:"ReadWeight",default:1}}}}}},table=$("#dbGroupTable"),editor;JSONEditor.defaults.options.theme="bootstrap3",JSONEditor.defaults.options.iconlib="bootstrap3",JSONEditor.defaults.options.disable_properties="true",JSONEditor.defaults.options.no_additional_properties="true",JSONEditor.defaults.options.disable_array_reorder="true",$("#save").click(function(){editor.validate().length||($("#save").prop("disabled",!0),$.ajax({contentType:"application/json",data:JSON.stringify(editor.getValue()),dataType:"json",success:function(e){$("#editModal").modal("hide"),$("#save").prop("disabled",!1),"OK"==e.result?table.bootstrapTable("refresh"):Common.info({title:"Error",message:"<b>"+e.result+"</b><br/>"+e.msg,operate:function(e){}})},error:function(e,t){alert(t),$("#save").prop("disabled",!1)},processData:!1,type:"POST",url:"../../api/dbgroup/save"}))});var loadDBNames=function(){a=new Array,$.ajax({contentType:"application/json",type:"GET",async:!1,success:function(e){$(e).each(function(e,t){a.push(t.Name)})},url:"../../api/db/all/pg"}),$.ajax({contentType:"application/json",type:"GET",async:!1,success:function(e){$(e).each(function(e,t){a.push(t.Name)})},url:"../../api/db/all/mysql"}),$.ajax({contentType:"application/json",type:"GET",async:!1,success:function(e){$(e).each(function(e,t){a.push(t.Name)})},url:"../../api/db/all/redis"}),scm.properties.Items.items.properties.Name.enum=a},optr=function(e,t,a){return"<input class='btn btn-info btn-xs edit' type='button' value='edit'></input> &nbsp;<input class='btn btn-danger btn-xs delete' type='button' value='delete'></input>"},items=function(e,t,a){var s="",o=!1,n=!1,r=new Array,l=new Array;$(e).each(function(e,t){l.indexOf(t.Name)==-1?l.push(t.Name):r.push(t.Name),t.IsMaster?(o=!0,s+='<span class="label label-success">M</span>'):(n=!0,s+='<span class="label label-info">S</span>'),s+="<b>",s+=t.Name,s+="</b>&nbsp;",s+="[",s+=t.ReadWeight,s+="]",s+="<br/>"}),o||(s+="<span class='label label-danger'>!</span><span style='background-color:#eee'>[error] No master supplied! </span><br/>"),n||(s+="<span class='label label-warning'>?</span><span style='background-color:#eee'>[warn] No slave supplied! </span><br/>");var i="";return $(r).each(function(e,t){i+=t+","}),""!=i&&(s+="<span class='label label-danger'>!</span><span style='background-color:#eee'>[error] Dup DBs:</span>["+i+"]"),s},state=function(e,t,a){return str="",t.Enable?str+='<span class="label label-success">yes</span>':str+='<span class="label label-danger">no</span>',str+="&nbsp;",0==t.State?str+='<span class="label label-success">ok</span>':str+='<span class="label label-danger">fail</span>',str};window.operateEvents={"click .edit":function(e,t,a,s){loadDBNames(),$("#editor_holder").html(""),editor=new JSONEditor(document.getElementById("editor_holder"),{schema:scm}),editor.setValue(a),editor.getEditor("root.Type").disable(),editor.getEditor("root.Name").disable(),editor.on("change",function(){$("#preview").html(syntaxHighlight(editor.getValue()))});var o=editor.validate();o.length&&alert(JSON.stringify(o)),$("#editModalTitle").html("Edit - "+a.Name),$("#editModal").modal("show")},"click .delete":function(e,t,a,s){Common.confirm({title:"Really?",message:"do you want delete <b>"+a.Name+"</b>?",operate:function(e){if(e){var t="../../api/dbgroup/delete/"+a.Name;$.ajax({contentType:"application/json",dataType:"json",success:function(e){"OK"==e.result?table.bootstrapTable("remove",{field:"Name",values:[a.Name]}):Common.info({title:"Error",message:"<b>"+e.result+"</b><br/>"+e.msg,operate:function(e){}})},error:function(e,t){Common.info({title:"Error",message:"<b>"+t+"</b><br/>"+JSON.stringify(e,null,2),operate:function(e){}})},processData:!1,type:"DELETE",url:t})}}})}},$(".addNewBtn").click(function(){loadDBNames(),$("#editor_holder").html(""),editor=new JSONEditor(document.getElementById("editor_holder"),{schema:scm}),editor.on("change",function(){$("#preview").html(syntaxHighlight(editor.getValue()))}),$("#editModalTitle").html("Add New DB Unit"),$("#editModal").modal("show")}),$("#tabScm").hide(),table.bootstrapTable()</script><div class="mt-1" style="border-top:.05rem solid #e5e5e5"><h1>Make your redis cheap and reliable</h1></div><p class="lead">rstore is a cluster database that use redis protocol and mysql|postgresql as its backend. with awesome dashboard.</p><p><a href="https://github.com/lycying/rstore" target="_blank">view the rstore</a></p></div><footer class="footer"><div class="container"><span class="text-muted">rstore: https://github.com/lycying/rstore</span></div></footer></body></html>